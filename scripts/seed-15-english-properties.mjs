import { createClient } from '@supabase/supabase-js'
import { readFileSync } from 'fs'
import { fileURLToPath } from 'url'
import { dirname, join } from 'path'

const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)

// Load .env.local
const envPath = join(__dirname, '..', '.env.local')
const envContent = readFileSync(envPath, 'utf8')
const envVars = {}
envContent.split('\n').forEach(line => {
  const match = line.match(/^([^#=]+)=(.*)$/)
  if (match) {
    const key = match[1].trim()
    const value = match[2].trim().replace(/^["']|["']$/g, '')
    envVars[key] = value
  }
})

const supabase = createClient(
  envVars.NEXT_PUBLIC_SUPABASE_URL,
  envVars.SUPABASE_SERVICE_ROLE_KEY
)

// Organization ID for English demo account (Mitchell Appraisal Group)
const EN_ORG_ID = '36261985-d5ed-43ac-bd5f-bed574824c6d'

const englishProperties = [
  // GTA Properties (Greater Toronto Area) - 7 properties
  {
    adresse: '88 Harbour Street, Unit 6503',
    ville: 'Toronto',
    municipalite: 'Toronto',
    code_postal: 'M5J 2S3',
    province: 'ON',
    type_propriete: 'Condo',
    genre_propriete: 'High-Rise',
    prix_vente: 1150000.00,
    prix_demande: 1199000.00,
    date_vente: '2024-10-18',
    status: 'Vendu',
    annee_construction: 2020,
    zonage: 'Residential',
    superficie_habitable_m2: 102.19,
    superficie_habitable_pi2: 1100.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 Parking + Locker',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'C9834521',
    source: 'import',
    notes: 'Waterfront condo with CN Tower views, concierge service',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '245 Bloor Street East',
    ville: 'Toronto',
    municipalite: 'Toronto',
    code_postal: 'M4W 3M1',
    province: 'ON',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 4250000.00,
    prix_demande: 4395000.00,
    date_vente: '2024-09-05',
    status: 'Vendu',
    annee_construction: 1920,
    zonage: 'Residential',
    superficie_terrain_m2: 743.22,
    superficie_terrain_pi2: 8000.00,
    frontage_m2: 18.29,
    profondeur_m2: 40.64,
    frontage_pi2: 60.00,
    profondeur_pi2: 133.33,
    superficie_habitable_m2: 418.06,
    superficie_habitable_pi2: 4500.00,
    nombre_chambres: 5,
    salle_bain: 4,
    salle_eau: 2,
    stationnement: 'Garage',
    dimension_garage: '6.10m x 6.10m (20ft x 20ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'Renovated Kitchen 2023, New HVAC',
    numero_mls: 'C9723456',
    source: 'manual',
    notes: 'Heritage home in Rosedale, fully renovated',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '2350 Yonge Street, Unit 1205',
    ville: 'Toronto',
    municipalite: 'North York',
    code_postal: 'M4P 2E5',
    province: 'ON',
    type_propriete: 'Condo',
    genre_propriete: 'High-Rise',
    prix_vente: 825000.00,
    prix_demande: 849000.00,
    date_vente: '2024-10-25',
    status: 'Vendu',
    annee_construction: 2018,
    zonage: 'Residential',
    superficie_habitable_m2: 83.61,
    superficie_habitable_pi2: 900.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 Parking',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'C9845123',
    source: 'inspection',
    notes: 'Bright corner unit, near Eglinton subway',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '45 The Kingsway',
    ville: 'Toronto',
    municipalite: 'Etobicoke',
    code_postal: 'M8X 2S9',
    province: 'ON',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 2950000.00,
    prix_demande: 3095000.00,
    date_vente: '2024-08-30',
    status: 'Vendu',
    annee_construction: 1935,
    zonage: 'Residential',
    superficie_terrain_m2: 929.03,
    superficie_terrain_pi2: 10000.00,
    frontage_m2: 20.12,
    profondeur_m2: 46.18,
    frontage_pi2: 66.00,
    profondeur_pi2: 151.50,
    superficie_habitable_m2: 325.16,
    superficie_habitable_pi2: 3500.00,
    nombre_chambres: 4,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Double Garage',
    dimension_garage: '6.10m x 12.19m (20ft x 40ft)',
    type_sous_sol: 'Partially Finished',
    toiture: 'Slate',
    ameliorations_hors_sol: 'Pool, Updated bathrooms',
    numero_mls: 'C9612345',
    source: 'import',
    notes: 'Prestigious Kingsway neighborhood',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '1888 Bayview Avenue',
    ville: 'Toronto',
    municipalite: 'North York',
    code_postal: 'M4G 3E6',
    province: 'ON',
    type_propriete: 'Duplex',
    genre_propriete: 'Semi-Detached',
    prix_vente: 1675000.00,
    prix_demande: 1725000.00,
    date_vente: '2024-09-20',
    status: 'Vendu',
    annee_construction: 1955,
    zonage: 'Residential',
    superficie_terrain_m2: 464.52,
    superficie_terrain_pi2: 5000.00,
    frontage_m2: 12.19,
    profondeur_m2: 38.10,
    frontage_pi2: 40.00,
    profondeur_pi2: 125.00,
    superficie_habitable_m2: 232.26,
    superficie_habitable_pi2: 2500.00,
    nombre_chambres: 6,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Driveway',
    type_sous_sol: 'Unfinished',
    toiture: 'Asphalt Shingle',
    numero_mls: 'C9756789',
    source: 'manual',
    notes: 'Excellent investment property, solid income',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '155 Dufferin Street, Unit 901',
    ville: 'Toronto',
    municipalite: 'Toronto',
    code_postal: 'M6K 3H6',
    province: 'ON',
    type_propriete: 'Condo',
    genre_propriete: 'Mid-Rise',
    prix_vente: 625000.00,
    prix_demande: 649000.00,
    date_vente: '2024-11-01',
    status: 'Vendu',
    annee_construction: 2016,
    zonage: 'Residential',
    superficie_habitable_m2: 65.03,
    superficie_habitable_pi2: 700.00,
    nombre_chambres: 1,
    salle_bain: 1,
    salle_eau: 0,
    stationnement: 'None',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'C9867234',
    source: 'inspection',
    notes: 'Ideal starter condo in Liberty Village',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '4285 Kingston Road',
    ville: 'Toronto',
    municipalite: 'Scarborough',
    code_postal: 'M1E 2M8',
    province: 'ON',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Bungalow',
    prix_vente: 1225000.00,
    prix_demande: 1275000.00,
    date_vente: '2024-10-12',
    status: 'Vendu',
    annee_construction: 1968,
    zonage: 'Residential',
    superficie_terrain_m2: 650.32,
    superficie_terrain_pi2: 7000.00,
    frontage_m2: 15.24,
    profondeur_m2: 42.67,
    frontage_pi2: 50.00,
    profondeur_pi2: 140.00,
    superficie_habitable_m2: 139.35,
    superficie_habitable_pi2: 1500.00,
    nombre_chambres: 3,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: 'Garage',
    dimension_garage: '6.10m x 6.10m (20ft x 20ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'New roof 2022, Updated kitchen',
    numero_mls: 'C9789456',
    source: 'import',
    notes: 'Large lot, great potential',
    organization_id: EN_ORG_ID
  },

  // Greater Vancouver Area - 5 properties
  {
    adresse: '1288 West Georgia Street, Unit 2105',
    ville: 'Vancouver',
    municipalite: 'Vancouver',
    code_postal: 'V6E 4R5',
    province: 'BC',
    type_propriete: 'Condo',
    genre_propriete: 'High-Rise',
    prix_vente: 1950000.00,
    prix_demande: 2050000.00,
    date_vente: '2024-09-15',
    status: 'Vendu',
    annee_construction: 2019,
    zonage: 'Residential',
    superficie_habitable_m2: 130.06,
    superficie_habitable_pi2: 1400.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 1,
    stationnement: '2 Parking + Storage',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'V9834521',
    source: 'import',
    notes: 'Coal Harbour luxury condo, water views',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '2755 West 16th Avenue',
    ville: 'Vancouver',
    municipalite: 'Vancouver',
    code_postal: 'V6K 3C4',
    province: 'BC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 3850000.00,
    prix_demande: 3995000.00,
    date_vente: '2024-08-22',
    status: 'Vendu',
    annee_construction: 2018,
    zonage: 'Residential',
    superficie_terrain_m2: 557.42,
    superficie_terrain_pi2: 6000.00,
    frontage_m2: 15.24,
    profondeur_m2: 36.58,
    frontage_pi2: 50.00,
    profondeur_pi2: 120.00,
    superficie_habitable_m2: 279.39,
    superficie_habitable_pi2: 3007.00,
    nombre_chambres: 5,
    salle_bain: 4,
    salle_eau: 1,
    stationnement: 'Double Garage',
    dimension_garage: '6.10m x 12.19m (20ft x 40ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'Smart home system, Radiant heating',
    numero_mls: 'V9723456',
    source: 'manual',
    notes: 'Kitsilano luxury home, modern design',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '1455 Bellevue Avenue',
    ville: 'West Vancouver',
    municipalite: 'West Vancouver',
    code_postal: 'V7V 1A6',
    province: 'BC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 6250000.00,
    prix_demande: 6595000.00,
    date_vente: '2024-07-18',
    status: 'Vendu',
    annee_construction: 2015,
    zonage: 'Residential',
    superficie_terrain_m2: 1393.55,
    superficie_terrain_pi2: 15000.00,
    frontage_m2: 27.43,
    profondeur_m2: 50.81,
    frontage_pi2: 90.00,
    profondeur_pi2: 166.67,
    superficie_habitable_m2: 465.10,
    superficie_habitable_pi2: 5006.00,
    nombre_chambres: 6,
    salle_bain: 6,
    salle_eau: 2,
    stationnement: 'Triple Garage',
    dimension_garage: '18.29m x 6.10m (60ft x 20ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Cedar Shake',
    ameliorations_hors_sol: 'Infinity pool, Ocean views, Wine cellar',
    numero_mls: 'V9612345',
    source: 'inspection',
    notes: 'Prestigious British Properties, panoramic views',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '8888 Odlin Crescent',
    ville: 'Richmond',
    municipalite: 'Richmond',
    code_postal: 'V6X 3Z8',
    province: 'BC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 2450000.00,
    prix_demande: 2550000.00,
    date_vente: '2024-10-08',
    status: 'Vendu',
    annee_construction: 2020,
    zonage: 'Residential',
    superficie_terrain_m2: 464.52,
    superficie_terrain_pi2: 5000.00,
    frontage_m2: 15.24,
    profondeur_m2: 30.48,
    frontage_pi2: 50.00,
    profondeur_pi2: 100.00,
    superficie_habitable_m2: 260.13,
    superficie_habitable_pi2: 2800.00,
    nombre_chambres: 5,
    salle_bain: 4,
    salle_eau: 1,
    stationnement: 'Double Garage',
    dimension_garage: '6.10m x 12.19m (20ft x 40ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'Radiant heating, Air conditioning',
    numero_mls: 'V9756789',
    source: 'import',
    notes: 'Modern luxury home, excellent school catchment',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '305 Lonsdale Avenue, Unit 1802',
    ville: 'North Vancouver',
    municipalite: 'North Vancouver',
    code_postal: 'V7M 2G3',
    province: 'BC',
    type_propriete: 'Condo',
    genre_propriete: 'High-Rise',
    prix_vente: 875000.00,
    prix_demande: 899000.00,
    date_vente: '2024-10-20',
    status: 'Vendu',
    annee_construction: 2017,
    zonage: 'Residential',
    superficie_habitable_m2: 92.90,
    superficie_habitable_pi2: 1000.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 Parking + Locker',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'V9867234',
    source: 'manual',
    notes: 'Mountain views, near Seabus terminal',
    organization_id: EN_ORG_ID
  },

  // Alberta Properties - 3 properties
  {
    adresse: '1088 6th Avenue SW, Unit 3201',
    ville: 'Calgary',
    municipalite: 'Calgary',
    code_postal: 'T2P 5N3',
    province: 'AB',
    type_propriete: 'Condo',
    genre_propriete: 'High-Rise',
    prix_vente: 625000.00,
    prix_demande: 649000.00,
    date_vente: '2024-10-05',
    status: 'Vendu',
    annee_construction: 2019,
    zonage: 'Residential',
    superficie_habitable_m2: 111.48,
    superficie_habitable_pi2: 1200.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '2 Parking',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'A9834521',
    source: 'inspection',
    notes: 'Downtown Calgary, executive condo',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '45 Aspen Summit View SW',
    ville: 'Calgary',
    municipalite: 'Calgary',
    code_postal: 'T3H 0H8',
    province: 'AB',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 1450000.00,
    prix_demande: 1495000.00,
    date_vente: '2024-09-12',
    status: 'Vendu',
    annee_construction: 2016,
    zonage: 'Residential',
    superficie_terrain_m2: 650.32,
    superficie_terrain_pi2: 7000.00,
    frontage_m2: 18.29,
    profondeur_m2: 35.56,
    frontage_pi2: 60.00,
    profondeur_pi2: 116.67,
    superficie_habitable_m2: 325.16,
    superficie_habitable_pi2: 3500.00,
    nombre_chambres: 5,
    salle_bain: 4,
    salle_eau: 1,
    stationnement: 'Triple Garage',
    dimension_garage: '9.14m x 6.10m (30ft x 20ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'Built-in speakers, Central A/C',
    numero_mls: 'A9723456',
    source: 'import',
    notes: 'Luxury estate in Aspen Woods',
    organization_id: EN_ORG_ID
  },
  {
    adresse: '10234 124 Street NW',
    ville: 'Edmonton',
    municipalite: 'Edmonton',
    code_postal: 'T5N 1P6',
    province: 'AB',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Detached',
    prix_vente: 725000.00,
    prix_demande: 749000.00,
    date_vente: '2024-10-15',
    status: 'Vendu',
    annee_construction: 2018,
    zonage: 'Residential',
    superficie_terrain_m2: 557.42,
    superficie_terrain_pi2: 6000.00,
    frontage_m2: 15.24,
    profondeur_m2: 36.58,
    frontage_pi2: 50.00,
    profondeur_pi2: 120.00,
    superficie_habitable_m2: 232.26,
    superficie_habitable_pi2: 2500.00,
    nombre_chambres: 4,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Double Garage',
    dimension_garage: '6.10m x 12.19m (20ft x 40ft)',
    type_sous_sol: 'Fully Finished',
    toiture: 'Asphalt Shingle',
    ameliorations_hors_sol: 'Upgraded kitchen, Hardwood floors',
    numero_mls: 'A9612345',
    source: 'manual',
    notes: 'Riverdale neighborhood, walk to valley',
    organization_id: EN_ORG_ID
  }
]

async function seedEnglishProperties() {
  console.log('üåé Seeding 15 English Properties (GTA, Vancouver, Alberta)...\n')
  console.log(`üìç Organization: Mitchell Appraisal Group`)
  console.log(`üìß Demo Account: demo-en@valeamax.com\n`)

  let gta = 0, van = 0, ab = 0

  for (const property of englishProperties) {
    console.log(`üìç Inserting: ${property.adresse} (${property.ville}, ${property.province})`)

    const { data, error } = await supabase
      .from('properties')
      .insert(property)
      .select()

    if (error) {
      console.error(`   ‚ùå Error: ${error.message}`)
    } else {
      console.log(`   ‚úÖ Success! ID: ${data[0].id}`)
      if (property.province === 'ON') gta++
      else if (property.province === 'BC') van++
      else if (property.province === 'AB') ab++
    }
  }

  console.log('\n' + '='.repeat(70))
  console.log('‚ú® English Properties Seeded Successfully!')
  console.log('='.repeat(70))
  console.log(`\nüìä Distribution:`)
  console.log(`   GTA (Toronto):        ${gta} properties`)
  console.log(`   Greater Vancouver:    ${van} properties`)
  console.log(`   Alberta:              ${ab} properties`)
  console.log(`   TOTAL:                ${gta + van + ab} properties\n`)
}

seedEnglishProperties().catch(console.error)
