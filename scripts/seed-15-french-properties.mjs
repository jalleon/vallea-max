import { createClient } from '@supabase/supabase-js'
import { readFileSync } from 'fs'
import { fileURLToPath } from 'url'
import { dirname, join } from 'path'

const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)

// Load .env.local
const envPath = join(__dirname, '..', '.env.local')
const envContent = readFileSync(envPath, 'utf8')
const envVars = {}
envContent.split('\n').forEach(line => {
  const match = line.match(/^([^#=]+)=(.*)$/)
  if (match) {
    const key = match[1].trim()
    const value = match[2].trim().replace(/^["']|["']$/g, '')
    envVars[key] = value
  }
})

const supabase = createClient(
  envVars.NEXT_PUBLIC_SUPABASE_URL,
  envVars.SUPABASE_SERVICE_ROLE_KEY
)

// Organization ID for French demo account (√âvaluations Dubois Inc.)
const FR_ORG_ID = '32aaa7be-4163-4c75-bf22-9dbb5d7a339c'

const frenchProperties = [
  // Montreal Properties - 7 properties
  {
    adresse: '1288 avenue des Canadiens-de-Montr√©al, App. 3205',
    ville: 'Montreal',
    municipalite: 'Ville-Marie',
    code_postal: 'H3B 5G8',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 895000.00,
    prix_demande: 925000.00,
    date_vente: '2024-10-18',
    status: 'Vendu',
    annee_construction: 2019,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 102.19,
    superficie_habitable_pi2: 1100.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 int√©rieur + casier',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'M9834521',
    source: 'import',
    notes: 'Vue sur le fleuve et le Vieux-Port, service de conciergerie',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '3845 avenue Laval',
    ville: 'Montreal',
    municipalite: 'Le Plateau-Mont-Royal',
    code_postal: 'H2W 2H9',
    province: 'QC',
    type_propriete: 'Duplex',
    genre_propriete: 'Jumel√©',
    prix_vente: 1350000.00,
    prix_demande: 1395000.00,
    date_vente: '2024-09-05',
    status: 'Vendu',
    annee_construction: 1925,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 278.71,
    superficie_terrain_pi2: 3000.00,
    frontage_m2: 7.62,
    profondeur_m2: 36.58,
    frontage_pi2: 25.00,
    profondeur_pi2: 120.00,
    superficie_habitable_m2: 232.26,
    superficie_habitable_pi2: 2500.00,
    nombre_chambres: 5,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Stationnement arri√®re (2 places)',
    type_sous_sol: 'Semi-fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'Cuisine r√©nov√©e 2023, Salle de bain principale refaite',
    numero_mls: 'M9723456',
    source: 'manual',
    notes: 'Duplex patrimonial r√©nov√©, cachet d\'√©poque pr√©serv√©, pr√®s du parc Jeanne-Mance',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '4750 rue Jean-Brillant, App. 805',
    ville: 'Montreal',
    municipalite: 'C√¥te-des-Neiges',
    code_postal: 'H3T 1P1',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 485000.00,
    prix_demande: 499000.00,
    date_vente: '2024-10-25',
    status: 'Vendu',
    annee_construction: 2017,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 74.32,
    superficie_habitable_pi2: 800.00,
    nombre_chambres: 2,
    salle_bain: 1,
    salle_eau: 0,
    stationnement: '1 int√©rieur',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'M9845123',
    source: 'inspection',
    notes: 'Lumineux coin sud, pr√®s Universit√© de Montr√©al et m√©tro',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '225 rue Sherbrooke Ouest, App. 2102',
    ville: 'Montreal',
    municipalite: 'Ville-Marie',
    code_postal: 'H2X 1X4',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 1250000.00,
    prix_demande: 1295000.00,
    date_vente: '2024-08-30',
    status: 'Vendu',
    annee_construction: 2021,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 139.35,
    superficie_habitable_pi2: 1500.00,
    nombre_chambres: 3,
    salle_bain: 2,
    salle_eau: 1,
    stationnement: '2 int√©rieurs',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'M9612345',
    source: 'import',
    notes: 'Luxueux condo du Golden Square Mile, terrasse priv√©e avec vue montagne',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '5285 avenue de Gasp√©',
    ville: 'Montreal',
    municipalite: 'Rosemont‚ÄìLa Petite-Patrie',
    code_postal: 'H2T 2A1',
    province: 'QC',
    type_propriete: 'Triplex',
    genre_propriete: 'Isol√©',
    prix_vente: 925000.00,
    prix_demande: 975000.00,
    date_vente: '2024-09-20',
    status: 'Vendu',
    annee_construction: 1950,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 325.16,
    superficie_terrain_pi2: 3500.00,
    frontage_m2: 9.14,
    profondeur_m2: 35.56,
    frontage_pi2: 30.00,
    profondeur_pi2: 116.67,
    superficie_habitable_m2: 269.42,
    superficie_habitable_pi2: 2900.00,
    nombre_chambres: 9,
    salle_bain: 3,
    salle_eau: 0,
    stationnement: 'Garage (2 places)',
    dimension_garage: '6.10m x 6.10m (20pi x 20pi)',
    type_sous_sol: 'Non-fini',
    toiture: 'Bardeau d\'asphalte',
    numero_mls: 'M9756789',
    source: 'manual',
    notes: 'Excellent immeuble √† revenus, 3 logements 4¬Ω, bon rendement locatif',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '6825 rue Saint-Denis',
    ville: 'Montreal',
    municipalite: 'Villeray‚ÄìSaint-Michel',
    code_postal: 'H2S 2S4',
    province: 'QC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Bungalow',
    prix_vente: 625000.00,
    prix_demande: 649000.00,
    date_vente: '2024-11-01',
    status: 'Vendu',
    annee_construction: 1962,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 464.52,
    superficie_terrain_pi2: 5000.00,
    frontage_m2: 12.19,
    profondeur_m2: 38.10,
    frontage_pi2: 40.00,
    profondeur_pi2: 125.00,
    superficie_habitable_m2: 139.35,
    superficie_habitable_pi2: 1500.00,
    nombre_chambres: 3,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: 'Double',
    type_sous_sol: 'Enti√®rement fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'Toiture 2022, Cuisine modernis√©e',
    numero_mls: 'M9867234',
    source: 'inspection',
    notes: 'Bungalow bien entretenu, grand terrain, secteur familial',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '1455 rue Sherbrooke Ouest, App. 1506',
    ville: 'Montreal',
    municipalite: 'Ville-Marie',
    code_postal: 'H3G 1L2',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 725000.00,
    prix_demande: 749000.00,
    date_vente: '2024-10-12',
    status: 'Vendu',
    annee_construction: 2018,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 92.90,
    superficie_habitable_pi2: 1000.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 int√©rieur',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'M9789456',
    source: 'import',
    notes: 'Condo moderne centre-ville, pr√®s McGill et m√©tro Guy-Concordia',
    organization_id: FR_ORG_ID
  },

  // Quebec City Properties - 5 properties
  {
    adresse: '1200 avenue Myrand, App. 1403',
    ville: 'Quebec',
    municipalite: 'Sainte-Foy‚ÄìSillery‚ÄìCap-Rouge',
    code_postal: 'G1V 2V3',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 425000.00,
    prix_demande: 445000.00,
    date_vente: '2024-09-15',
    status: 'Vendu',
    annee_construction: 2016,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 102.19,
    superficie_habitable_pi2: 1100.00,
    nombre_chambres: 2,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: '1 int√©rieur + casier',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'Q9834521',
    source: 'import',
    notes: 'Condo luxueux, pr√®s Universit√© Laval et Place Laurier',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '865 avenue Murray',
    ville: 'Quebec',
    municipalite: 'Qu√©bec (arr. La Cit√©)',
    code_postal: 'G1S 3A6',
    province: 'QC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Cottage',
    prix_vente: 875000.00,
    prix_demande: 925000.00,
    date_vente: '2024-08-22',
    status: 'Vendu',
    annee_construction: 1935,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 557.42,
    superficie_terrain_pi2: 6000.00,
    frontage_m2: 15.24,
    profondeur_m2: 36.58,
    frontage_pi2: 50.00,
    profondeur_pi2: 120.00,
    superficie_habitable_m2: 232.26,
    superficie_habitable_pi2: 2500.00,
    nombre_chambres: 4,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Garage double',
    dimension_garage: '6.10m x 12.19m (20pi x 40pi)',
    type_sous_sol: 'Partiellement fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'R√©novation majeure 2020, Cuisine haut de gamme',
    numero_mls: 'Q9723456',
    source: 'manual',
    notes: 'Maison patrimoniale r√©nov√©e, quartier Montcalm prestigieux',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '2450 chemin Sainte-Foy',
    ville: 'Quebec',
    municipalite: 'Qu√©bec (arr. La Cit√©)',
    code_postal: 'G1V 1T6',
    province: 'QC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Isol√©',
    prix_vente: 695000.00,
    prix_demande: 725000.00,
    date_vente: '2024-07-18',
    status: 'Vendu',
    annee_construction: 2015,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 650.32,
    superficie_terrain_pi2: 7000.00,
    frontage_m2: 18.29,
    profondeur_m2: 35.56,
    frontage_pi2: 60.00,
    profondeur_pi2: 116.67,
    superficie_habitable_m2: 204.39,
    superficie_habitable_pi2: 2200.00,
    nombre_chambres: 4,
    salle_bain: 3,
    salle_eau: 1,
    stationnement: 'Garage double',
    dimension_garage: '6.10m x 12.19m (20pi x 40pi)',
    type_sous_sol: 'Enti√®rement fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'Thermopompe murale, Foyer au gaz',
    numero_mls: 'Q9612345',
    source: 'inspection',
    notes: 'Belle propri√©t√© r√©cente, secteur pris√© de Sainte-Foy',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '4285 boulevard Wilfrid-Hamel',
    ville: 'Quebec',
    municipalite: 'Qu√©bec (arr. Les Rivi√®res)',
    code_postal: 'G1P 2J3',
    province: 'QC',
    type_propriete: 'Duplex',
    genre_propriete: 'Jumel√©',
    prix_vente: 425000.00,
    prix_demande: 449000.00,
    date_vente: '2024-10-08',
    status: 'Vendu',
    annee_construction: 1978,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 372.61,
    superficie_terrain_pi2: 4010.00,
    frontage_m2: 12.19,
    profondeur_m2: 30.48,
    frontage_pi2: 40.00,
    profondeur_pi2: 100.00,
    superficie_habitable_m2: 167.23,
    superficie_habitable_pi2: 1800.00,
    nombre_chambres: 4,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: 'Double',
    type_sous_sol: 'Semi-fini',
    toiture: 'Bardeau d\'asphalte',
    numero_mls: 'Q9756789',
    source: 'import',
    notes: 'Bon immeuble √† revenus, secteur tranquille, bien entretenu',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '1755 rue des Pionniers-de-la-Beauce',
    ville: 'Quebec',
    municipalite: 'Sainte-Foy‚ÄìSillery‚ÄìCap-Rouge',
    code_postal: 'G1X 4N5',
    province: 'QC',
    type_propriete: 'Appartement',
    genre_propriete: 'Rez-de-chauss√©e',
    prix_vente: 285000.00,
    prix_demande: 299000.00,
    date_vente: '2024-10-20',
    status: 'Vendu',
    annee_construction: 2019,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 74.32,
    superficie_habitable_pi2: 800.00,
    nombre_chambres: 2,
    salle_bain: 1,
    salle_eau: 0,
    stationnement: '1 ext√©rieur assign√©',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'Q9867234',
    source: 'manual',
    notes: 'Appartement lumineux au rez-de-chauss√©e, id√©al premier achat',
    organization_id: FR_ORG_ID
  },

  // Gatineau Properties - 3 properties
  {
    adresse: '455 boulevard de la Gappe',
    ville: 'Gatineau',
    municipalite: 'Gatineau (Aylmer)',
    code_postal: 'J9H 6Z9',
    province: 'QC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Isol√©',
    prix_vente: 545000.00,
    prix_demande: 575000.00,
    date_vente: '2024-10-05',
    status: 'Vendu',
    annee_construction: 2017,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 464.52,
    superficie_terrain_pi2: 5000.00,
    frontage_m2: 15.24,
    profondeur_m2: 30.48,
    frontage_pi2: 50.00,
    profondeur_pi2: 100.00,
    superficie_habitable_m2: 167.23,
    superficie_habitable_pi2: 1800.00,
    nombre_chambres: 3,
    salle_bain: 2,
    salle_eau: 1,
    stationnement: 'Garage double',
    dimension_garage: '6.10m x 12.19m (20pi x 40pi)',
    type_sous_sol: 'Enti√®rement fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'Thermopompe centrale, Patio',
    numero_mls: 'G9834521',
    source: 'inspection',
    notes: 'Maison moderne √† aire ouverte, secteur familial d\'Aylmer',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '125 rue du Plateau',
    ville: 'Gatineau',
    municipalite: 'Gatineau (Hull)',
    code_postal: 'J8Y 1W2',
    province: 'QC',
    type_propriete: 'Condo',
    genre_propriete: 'Tour',
    prix_vente: 325000.00,
    prix_demande: 339000.00,
    date_vente: '2024-09-12',
    status: 'Vendu',
    annee_construction: 2020,
    zonage: 'R√©sidentiel',
    superficie_habitable_m2: 74.32,
    superficie_habitable_pi2: 800.00,
    nombre_chambres: 2,
    salle_bain: 1,
    salle_eau: 0,
    stationnement: '1 int√©rieur',
    type_sous_sol: 'N/A',
    toiture: 'N/A',
    numero_mls: 'G9723456',
    source: 'import',
    notes: 'Condo neuf, centre-ville Hull, pr√®s des ponts vers Ottawa',
    organization_id: FR_ORG_ID
  },
  {
    adresse: '88 rue de la Savane',
    ville: 'Gatineau',
    municipalite: 'Gatineau (Buckingham)',
    code_postal: 'J8L 2P5',
    province: 'QC',
    type_propriete: 'Unifamiliale',
    genre_propriete: 'Bungalow',
    prix_vente: 385000.00,
    prix_demande: 399000.00,
    date_vente: '2024-10-15',
    status: 'Vendu',
    annee_construction: 1985,
    zonage: 'R√©sidentiel',
    superficie_terrain_m2: 743.22,
    superficie_terrain_pi2: 8000.00,
    frontage_m2: 18.29,
    profondeur_m2: 40.64,
    frontage_pi2: 60.00,
    profondeur_pi2: 133.33,
    superficie_habitable_m2: 130.06,
    superficie_habitable_pi2: 1400.00,
    nombre_chambres: 3,
    salle_bain: 2,
    salle_eau: 0,
    stationnement: 'Garage simple + stationnement double',
    dimension_garage: '6.10m x 6.10m (20pi x 20pi)',
    type_sous_sol: 'Enti√®rement fini',
    toiture: 'Bardeau d\'asphalte',
    ameliorations_hors_sol: 'Fen√™tres r√©centes, Cabanon',
    numero_mls: 'G9612345',
    source: 'manual',
    notes: 'Bungalow spacieux, grand terrain bois√©, secteur paisible de Buckingham',
    organization_id: FR_ORG_ID
  }
]

async function seedFrenchProperties() {
  console.log('üá´üá∑ Seeding 15 French Properties (Montreal, Quebec City, Gatineau)...\n')
  console.log(`üìç Organization: √âvaluations Dubois Inc.`)
  console.log(`üìß Demo Account: demo-fr@valeamax.com\n`)

  let mtl = 0, qc = 0, gat = 0

  for (const property of frenchProperties) {
    console.log(`üìç Inserting: ${property.adresse} (${property.ville}, ${property.province})`)

    const { data, error } = await supabase
      .from('properties')
      .insert(property)
      .select()

    if (error) {
      console.error(`   ‚ùå Error: ${error.message}`)
    } else {
      console.log(`   ‚úÖ Success! ID: ${data[0].id}`)
      if (property.ville === 'Montreal') mtl++
      else if (property.ville === 'Quebec') qc++
      else if (property.ville === 'Gatineau') gat++
    }
  }

  console.log('\n' + '='.repeat(70))
  console.log('‚ú® French Properties Seeded Successfully!')
  console.log('='.repeat(70))
  console.log(`\nüìä Distribution:`)
  console.log(`   Montreal:             ${mtl} properties`)
  console.log(`   Quebec City:          ${qc} properties`)
  console.log(`   Gatineau:             ${gat} properties`)
  console.log(`   TOTAL:                ${mtl + qc + gat} properties\n`)
}

seedFrenchProperties().catch(console.error)
